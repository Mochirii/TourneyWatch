<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" type="text/css" href="/styles/jquery.bracket.min.css" />
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="/scripts/jquery.bracket.min.js"></script>
    <script type="text/javascript" src="/scripts/app.js"></script>
    <script type="text/javascript">
        $(function () {
            var demos = ['save', ]
            $.each(demos, function (i, d) {
                var demo = $('div#' + d)
                $('<div class="demo"></div>').appendTo(demo)
            })
        })

        var saveData = {
            "teams": [
                [
                    { name: "Team 1", flag: 'in' },
                    { name: "Team 2", flag: 'in' },
                ],
                [
                    { name: "Team 3", flag: 'in' },
                    { name: "Team 4", flag: 'in' },
                ],
                [
                    { name: "Team 5", flag: 'in' },
                    { name: "Team 6", flag: 'in' }
                ],
                [
                    { name: "Team 7", flag: 'in' },
                    { name: "Team 8", flag: 'in' },
                ],
           

            ],

            results: [[[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0]]],
        };
        /* Called whenever bracket is modified
         *
         * data:     changed bracket object in format given to init
         * userData: optional data given when bracket is created.
         */
         function saveFn(data) {
            var json = JSON.stringify(data)
            console.log(json);
            // $('#saveOutput').text('POST '+userData+' '+json)
            alert("The paragraph was clicked.");

            /* You probably want to do something like this
            jQuery.ajax("rest/"+userData, {contentType: 'application/json',
                                          dataType: 'json',
                                          type: 'post',
                                          data: json})
            */
          }
        
          $(function() {
              var container = $('div#save .demo')
              container.bracket({
                init: saveData,
                save: saveFn,
                userData: "http://myapi"})
        
              /* You can also inquiry the current data */
              
            //   $('#dataOutput').text(JSON.parse(data))


            $("#target").click(function() {
                var data = container.bracket('data')
                console.log("data", data)
                saveFn(data);
          });


            })

        /*for flag*/
        /* Edit function is called when team label is clicked */
        function edit_fn(container, data, doneCb) {
            var input = $('<input type="text">')
            input.val(data ? data.flag + ':' + data.name : '')
            container.html(input)
            input.focus()
            input.blur(function () {
                var inputValue = input.val()
                if (inputValue.length === 0) {
                    doneCb(null); // Drop the team and replace with BYE
                } 
            })
        }

        /* Render function is called for each team label when data is changed, data
         * contains the data object given in init and belonging to this slot.
         *
         * 'state' is one of the following strings:
         * - empty-bye: No data or score and there won't team advancing to this place
         * - empty-tbd: No data or score yet. A team will advance here later
         * - entry-no-score: Data available, but no score given yet
         * - entry-default-win: Data available, score will never be given as opponent is BYE
         * - entry-complete: Data and score available
         */
        function render_fn(container, data, score, state) {
            console.log(container)
            console.log('data, ' + data);

            console.log('score, ' + score);

            console.log('state, ' + state);

            switch (state) {
               
                case "empty-tbd":
                    container.append("Upcoming")
                    return;

                case "entry-no-score":
                case "entry-default-win":
                case "entry-complete":
                    container.append(data.name)
                    return;
            }
        }

        $(function () {
            $('div#save .demo').bracket({
                teamWidth: 80,
                scoreWidth: 20,
                matchMargin: 10,
                roundMargin: 30,
                centerConnectors: true,
                init: saveData,
                disableToolbar: true,
                disableTeamEdit: true,
                save: function () { }, /* without save() labels are disabled */
                decorator: {
                    edit: edit_fn,
                    render: render_fn
                }
            })
        })



        $(document).ready(function(){


        });

    </script>
 
</head>

<body>
        <% include partials/navbar %>

    <main>
        <div id="save" style="display: inline-block;">

        </div>
        <button class="submit butt0n" id="target">Save</button>

    </main>

   

</body>

</html>
